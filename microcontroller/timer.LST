C51 COMPILER V9.00   TIMER                                                                 05/05/2016 01:06:09 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE TIMER
OBJECT MODULE PLACED IN timer.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE timer.c ROM(COMPACT) BROWSE DEBUG OBJECTEXTEND

line level    source

   1          #include "reg52.h"
   2          #include <string.h>
   3          #include <stdarg.h>
   4          #include <stdio.h>
   5          
   6          
   7          #include "timer.h"
   8          #include "user_sys.h"
   9          
  10          //sbit LED1=P1^7;//声明端口
  11          
  12          void Init_Timer0(void)            //定时器初始化子程序
  13          {
  14   1              TMOD |= 0x01;     //使用模式1，16位定时器，使用"|"符号可以在使用多个定时器时不受影响                 
  15   1              TH0=65536-65036;              //给定初值，这里使用定时器最大值从0开始计数一直到65535溢出
  16   1              TL0=65536-65036;
  17   1              EA=1;            //总中断打开
  18   1              ET0=1;           //定时器中断打开
  19   1              TR0=1;           //定时器开关打开
  20   1      }
  21          
  22          
  23          /*******************************************************************************
  24          ** 函数功能 ： 定时器中断程序
  25          *******************************************************************************/
  26          
  27          void Timer0_isr(void) interrupt 1 using 1
  28          {
  29   1              TH0=65536-65036;              //给定初值，这里使用定时器最大值从0开始计数一直到65535溢出
  30   1              TL0=65536-65036;
  31   1              //LED1=~LED1;        //指示灯反相，可以看到闪烁
  32   1              userSystemHandle();
  33   1      }
  34          
  35          /*------------------------------------------------
  36                              定时器初始化子程序
  37          ------------------------------------------------*/
  38          /*void Init_Timer0(void)
  39          {
  40           TMOD |= 0x01;    //使用模式1，16位定时器，使用"|"符号可以在使用多个定时器时不受影响                 
  41           TH0=(65536-1000)/256;            //重新赋值 2ms
  42           TL0=(65536-1000)%256;
  43          
  44           EA=1;            //总中断打开
  45           ET0=1;           //定时器中断打开
  46           TR0=1;           //定时器开关打开
  47          }
  48                             */
  49          /*------------------------------------------------
  50                              定时器初始化子程序
  51          ------------------------------------------------*/
  52          void Init_Timer1(void)
  53          {
  54   1       TMOD |= 0x10;    //使用模式1，16位定时器，使用"|"符号可以在使用多个定时器时不受影响 
  55   1       TH1=0x55;            //给定初值，这里使用定时器最大值从0开始计数一直到65535溢出
C51 COMPILER V9.00   TIMER                                                                 05/05/2016 01:06:09 PAGE 2   

  56   1       TL1=0x55;
  57   1       EA=1;            //总中断打开
  58   1       ET1=1;           //定时器中断打开
  59   1       TR1=1;           //定时器开关打开
  60   1      }
  61          /*------------------------------------------------
  62                           定时器中断子程序
  63          ------------------------------------------------*/
  64          void Timer1_isr(void) interrupt 3 using 1
  65          {
  66   1              TH1=0x55;                //给定初值，这里使用定时器最大值从0开始计数一直到65535溢出
  67   1              TL1=0x55;
  68   1      }
  69          /*------------------------------------------------
  70                              定时器初始化子程序
  71          ------------------------------------------------*/
  72          void TIM2Inital(void)
  73          {
  74   1        RCAP2H = (65536-10000)/256;//晶振12M 60ms 16bit 自动重载
  75   1        RCAP2L = (65536-10000)%256;
  76   1        ET2=1;                     //打开定时器中断
  77   1        EA=1;                      //打开总中断
  78   1        TR2=1;                     //打开定时器开关
  79   1      }
  80          
  81          /*------------------------------------------------
  82                           定时器中断子程序
  83          ------------------------------------------------*/
  84          void TIM2(void) interrupt 5 using 1//定时器2中断
  85          {
  86   1          TF2=0; 
  87   1              //P1 = ~P1;
  88   1              userSystemHandle();
  89   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    114    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
